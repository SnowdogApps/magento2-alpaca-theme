<?php
/* @var $block \Magento\Wishlist\Block\Customer\Wishlist\Item\Column\Cart */
/* @var \Magento\Wishlist\Model\Item $item */
$item = $block->getItem();
$product = $item->getProduct();
/** @var \Magento\Wishlist\ViewModel\AllowedQuantity $viewModel */
$viewModel = $block->getData('allowedQuantityViewModel');
$allowedQty = $viewModel->setItem($item)->getMinMaxQty();
?>
<?php foreach ($block->getChildNames() as $childName): ?>
    <?= $block->getLayout()->renderElement($childName, false); ?>
<?php endforeach; ?>

<?php if ($item->canHaveQty() && $product->isVisibleInSiteVisibility()): ?>
    <div class="
        input
        input--inline
        wishlist__qty"
    >
        <label
            for="qty[<?= $item->getId() ?>]"
            class="label wishlist__label"
        >
            <?= __('Qty') ?>:
        </label>
        <input
            type="number"
            data-role="qty"
            id="qty[<?= $item->getId() ?>]"
            class="input__field wishlist__field-qty qty"
            data-validate="{
                'required-number':true,
                'validate-greater-than-zero':true,
                'validate-item-quantity': {
                    'minAllowed':<?= /* @noEscape */ $allowedQty['minAllowed'] ?>,
                    'maxAllowed':<?= /* @noEscape */ $allowedQty['maxAllowed'] ?>
                }
            }"
            name="qty[<?= $escaper->escapeHtmlAttr($item->getId()) ?>]"
            value="<?= /* @noEscape */ $block->getAddToCartQty($item) * 1 ?>"
            <?= $product->isSaleable() ? '' : 'disabled="disabled"' ?>
        >
    </div>
<?php endif; ?>

<?php if ($product->isSaleable()): ?>
    <div class="wishlist__item-actions wishlist__item-actions--to-cart">
        <button
            type="button"
            data-role="tocart"
            data-post='<?= $block->getItemAddToCartParams($item) ?>'
            title="<?= $escaper->escapeHtmlAttr(__('Add to Cart')) ?>"
            data-item-id="<?= $item->getId() ?>"
            class="
                button
                action__button
                tocart
                primary
                wishlist__button
            "
        >
            <?= __('Add to Cart') ?>
        </button>
    </div>
<?php else: ?>
    <?php if ($product->getIsSalable()): ?>
        <p class="available stock" title="<?= $escaper->escapeHtmlAttr(__('Availability')) ?>">
            <?= __('In stock') ?>
        </p>
    <?php else: ?>
        <p class="unavailable stock" title="<?= $escaper->escapeHtmlAttr(__('Availability')) ?>">
            <?= __('Out of stock') ?>
        </p>
    <?php endif; ?>
<?php endif; ?>
