<!-- ko foreach: getRegion('amazon-button-region') -->
<!-- ko template: getTemplate() --><!-- /ko -->
<!-- /ko -->

<!-- ko ifnot: isCustomerLoggedIn() -->

<!-- ko foreach: getRegion('before-login-form') -->
<!-- ko template: getTemplate() --><!-- /ko -->
<!-- /ko -->
<form 
    class="
        form 
        form-login
    " 
    data-role="email-with-possible-login"
    data-bind="submit:login"
    method="post"
>
    <fieldset 
        id="customer-email-fieldset" 
        class="fieldset" 
        data-bind="blockLoader: isLoading"
    >
        <div 
            class="
                field 
                input 
                required
            "
        >
            <label 
                class="
                    label 
                    input__label
                " 
                for="customer-email"
            >
                <span data-bind="i18n: 'Email Address'"></span>
            </label>
            <div class="control _with-tooltip">
                <input 
                    class="
                        input-text
                        input__field
                    "
                    type="email"
                    data-bind="
                        textInput: email,
                        hasFocus: emailFocused,
                        mageInit: {'mage/trim-input':{}}"
                    "
                    name="username"
                    data-validate="{required:true, 'validate-email':true}"
                    id="customer-email" 
                />
                <!-- ko template: 'ui/form/element/helper/tooltip' --><!-- /ko -->
                <span 
                    class="note" 
                    data-bind="fadeVisible: isPasswordVisible() == false"
                >
                    <!-- ko i18n: 'You can create an account after checkout.'--><!-- /ko -->
                </span>
            </div>
        </div>

        <!--Hidden fields -->
        <fieldset 
            class="fieldset hidden-fields" 
            data-bind="fadeVisible: isPasswordVisible"
        >
            <div class="field input">
                <label 
                    class="
                        label
                        input__label    
                    " 
                    for="customer-password"
                >
                    <span data-bind="i18n: 'Password'"></span>
                </label>
                <div class="control">
                    <input 
                        class="
                            input-text
                            input__field
                        "
                        placeholder="optional"
                        type="password"
                        name="password"
                        id="customer-password"
                        data-validate="{required:true}" 
                        autocomplete="off"
                    />
                    <span 
                        class="
                            note 
                            customer-note
                        " 
                        data-bind="i18n: 'You already have an account with us. Sign in or continue as guest.'"
                    ></span>
                </div>

            </div>
            <!-- ko foreach: getRegion('additional-login-form-fields') -->
            <!-- ko template: getTemplate() --><!-- /ko -->
            <!-- /ko -->
            <div class="login-buttons">
                <input 
                    name="context" 
                    type="hidden"
                    value="checkout" 
                />
                <button 
                    type="submit" 
                    class="
                        button 
                        button--secondary
                    " 
                    data-action="checkout-method-login"
                >
                    <span data-bind="i18n: 'Login'"></span>
                </button>
                <a 
                    class="
                        action 
                        remind
                    " 
                    data-bind="attr: { href: forgotPasswordUrl }"
                >
                    <span data-bind="i18n: 'Forgot Your Password?'"></span>
                </a>
            </div>
        </fieldset>
        <!--Hidden fields -->
    </fieldset>
</form>
<!-- /ko -->
